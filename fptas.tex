
\section{Computation Tree for Marginal Probability}
%P(G,e,C,L) - P(G,e,C',L)

We may compute the marginal probability $P(G, e)$ with the previous recursion, but
that could take recursion depth of $O(n)$ which results in exponential computation time.

So here we use a truncated computation tree for an estimate of $P(G,e)$,
note the recursion depth here is actually the so-called $M$-based depth introduced in \cite{LLY12}.

\IncMargin{1em}
\begin{algorithm}[H]
\SetKwInOut{Input}{input}\SetKwInOut{Output}{output}
\emph{ \textbf{function} $P(G, e, L):$}
\BlankLine
\Input{Graph $G$; edge $e$; Recursion depth $L$; }
\Output{Estimate of $P(G,e)$ up to depth $L$ .}
\Begin{
	\If{$L=0$ }{\Return{ $\frac{1}{2}$}}
	\ElseIf{$e$ is free }{
		\Return{ $\frac{1}{2}$}\;
	}
	\ElseIf{$e$ is dangling }{
		$L' \leftarrow L - \lceil \log_M\left( d + 1 \right) \rceil$\;
		\Return{ $\frac{1-\prod_{i=1}^d P(G_i, e_i, C, L')}{2 - \prod_{i=1}^d P(G_i, e_i, C, L')}$} \;
	}
	\Else(// $e$ is normal ){
		$X \leftarrow \prod_{i=1}^{d_1} P(G_i^1, e_i, C, L)$\;
		$Y \leftarrow \prod_{i=1}^{d_2} P(G_i^2, f_i, C, L)$\;
		$Z \leftarrow \prod_{i=1}^{d_2} P(G_i^3, f_i, C, L)$\;
		\Return{ $1 - \cfrac{1}{2+ X\cdot Y  - X - Z }$ }\;
	}
 }
 \caption{Estimate $P(G,e)$ up to M-based depth $L$}
\end{algorithm}
\DecMargin{1em}

